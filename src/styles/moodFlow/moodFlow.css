:root {
    --mf-bg: #ffffff; 
    --mf-text: #1a1a1a; 
    --mf-text-muted: #8e8e93;
    --mf-border: #f2f2f7; 
    --mf-primary: #000000;
    --s1: #ff3b30; --s2: #ff9500; --s3: #ffcc00; --s4: #34c759; --s5: #008a00;
    --skipped: #f2f2f7; 
    --birthday: #ff8eb2;
    --b1: #d81b60; --b2: #e91e63; --b3: #f06292; --b4: #f8bbd0; --b5: #fce4ec;
   }
   
   .mf-module { padding: 0 40px 40px 40px; background: var(--mf-bg); color: var(--mf-text); font-family: -apple-system, sans-serif; }
   
   /* Header & Birthday */
   .mf-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 40px; }
   .mf-header h1 { font-size: 32px; font-weight: 800; letter-spacing: -1px; margin: 0; }
   .mf-birthday-card { background: #fbfbfd; padding: 12px 20px; border-radius: 15px; border: 1px solid #eee; display: flex; flex-direction: column; gap: 8px; margin-top: 15px; }
   .bd-label { font-size: 11px; font-weight: 800; color: var(--mf-text-muted); text-transform: uppercase; }
   .mf-birthday-inputs { display: flex; align-items: center; gap: 8px; }
   .mf-birthday-inputs input { width: 45px; border: none; background: transparent; font-size: 16px; font-weight: 700; text-align: center; border-bottom: 2px solid #ddd; outline: none; }
   .mf-birthday-inputs input#bd-year { width: 70px; }
   .mf-birthday-inputs span { font-weight: 800; color: #ddd; }
   .mf-btn-save-bd { background: #000; color: #fff; border: none; padding: 6px 15px; border-radius: 10px; cursor: pointer; font-size: 12px; font-weight: 700; margin-left: 10px; }
   
   /* Stats Board */
   .mf-summary-grid { display: flex; gap: 12px; margin-bottom: 30px; }
   .summary-card { flex: 1; background: #fff; padding: 15px; border-radius: 18px; border: 1px solid #f2f2f7; display: flex; flex-direction: column; align-items: center; gap: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
   .summary-card strong { font-size: 20px; font-weight: 800; }
   .summary-card label { font-size: 9px; font-weight: 800; color: var(--mf-text-muted); }
   .summary-card .dot { width: 6px; height: 6px; border-radius: 50%; background: var(--c); }
   
   /* Nav & Segmented */
   .mf-calendar-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
   .nav-month-selector { display: flex; align-items: center; gap: 15px; font-weight: 700; font-size: 18px; }
   .nav-arrow { background: none; border: none; cursor: pointer; font-size: 16px; }
   .mf-segmented-control { display: flex; background: #f2f2f7; padding: 4px; border-radius: 12px; position: relative; width: 180px; }
   .seg-btn { flex: 1; border: none; background: transparent; padding: 6px; font-weight: 700; font-size: 12px; z-index: 2; cursor: pointer; color: #8e8e93; }
   .seg-btn.active { color: #000; }
   .seg-glider { position: absolute; height: calc(100% - 8px); width: calc(33.33% - 4px); background: #fff; border-radius: 10px; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
   
   /* Grids - Fix Container Positioning */
   .mf-container { position: relative; width: 100%; } /* Quan trọng để tooltip không nhảy */
   .mf-grid-scroll-container { overflow-x: auto; padding: 10px 0; }
   .mf-grid { display: grid; gap: 10px; width: 100%; position: relative; }
   
   .px-box { position: relative; aspect-ratio: 1; border-radius: 8px; background: #f2f2f7; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; color: rgba(0,0,0,0.15); cursor: pointer; }
   
   .mf-grid.month-view { grid-template-columns: repeat(7, 1fr); max-width: 420px; margin: 0 auto; }
   .mf-grid.week-view { grid-template-columns: repeat(7, 1fr); gap: 15px; padding-top: 10px; }
   .mf-grid.week-view .px-box { height: 160px; border-radius: 20px; flex-direction: column; background: #f8f8fa; border: 1px solid #eee; aspect-ratio: auto; }
   .mf-grid.week-view .px-box .mood-emoji { font-size: 36px; margin-bottom: 10px; }
   .mf-grid.week-view .px-box .day-sub { font-size: 11px; color: var(--mf-text-muted); margin-top: auto; padding-bottom: 15px; }
   .week-img {
    object-fit: contain;
    width: 100%;
   }
   .week-wrap {
    margin-top: 10px;
    padding: 5px;
    width: 100%;
    height: 100%;
    max-width: 60px;
    max-height: 60px;
    border-radius: 100%;
    background-color: white;
    }
   
   /* Year View - Fix Height */
   .mf-grid.year-view { grid-template-columns: 30px repeat(12, 1fr); gap: 4px; font-size: 0; }
   .mf-grid.year-view .px-box { height: 18px; border-radius: 3px; aspect-ratio: auto; }
   .year-header-col { font-size: 10px; font-weight: 800; color: #ddd; text-align: center; padding-bottom: 5px; }
   .year-row-label { font-size: 10px; font-weight: 800; color: #ddd; display: flex; align-items: center; justify-content: center; }
   
   /* Highlight Today */
   .px-box.today-highlight:not(.s1):not(.s2):not(.s3):not(.s4):not(.s5) { border: 2px solid var(--mf-primary); background: #fff; color: var(--mf-primary); font-weight: 900; }
   
   .px-box.s1 { background: var(--s1) !important; color: #fff; }
   .px-box.s2 { background: var(--s2) !important; color: #fff; }
   .px-box.s3 { background: var(--s3) !important; color: #000; }
   .px-box.s4 { background: var(--s4) !important; color: #000; }
   .px-box.s5 { background: var(--s5) !important; color: #fff; }
   .px-box.birthday { background: var(--birthday) !important; border: 2px solid #ff69b4 !important; color: #fff !important; }
   .px-box.past-empty { background: #f2f2f7; color: transparent; }
   .px-box.future { opacity: 0.3; cursor: default; }
   
   .px-box:not(.future):hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
   
   /* Legend */
   .mf-legend { display: flex; gap: 15px; justify-content: center; margin-top: 25px; padding-top: 20px; border-top: 1px solid #f2f2f7; flex-wrap: wrap; }
   .legend-item { display: flex; align-items: center; gap: 8px; font-size: 11px; font-weight: 700; color: var(--mf-text-muted); }
   .legend-item .dot { width: 10px; height: 10px; border-radius: 3px; background: var(--skipped); }
   .legend-item .dot.s5 { background: var(--s5); } .legend-item .dot.s4 { background: var(--s4); }
   .legend-item .dot.s3 { background: var(--s3); } .legend-item .dot.s2 { background: var(--s2); } 
   .legend-item .dot.s1 { background: var(--s1); } .legend-item .dot.skipped { background: var(--skipped); }
   
   /* Modal & Others (Giữ nguyên UI của bạn) */
   .mf-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(8px); z-index: 1000; display: flex; align-items: center; justify-content: center; }
   .mf-modal-card { background: #fff; width: 440px; border-radius: 30px; padding: 40px; box-shadow: 0 30px 60px rgba(0,0,0,0.15); border: 1px solid #f2f2f7; position: relative; }
   .modal-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; }
   .modal-subtitle { font-size: 11px; font-weight: 800; color: var(--mf-text-muted); text-transform: uppercase; display: block; }
   .modal-title { font-size: 24px; font-weight: 800; margin: 5px 0 0; }
   .btn-close-modal { background: #f2f2f7; border: none; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; }
   .mf-display-card { display: flex; align-items: center; gap: 20px; background: #fbfbfd; padding: 25px; border-radius: 20px; margin-bottom: 25px; }
   .mood-icon-wrap img { width: 60px; height: 60px; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.1)); object-fit: contain; }
   #view-time { font-size: 12px; font-weight: 800; color: var(--mf-text-muted); }
   #view-note { margin: 5px 0 0; font-size: 16px; font-weight: 500; }
   .mood-selection-wrapper { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0; }
   .mood-item { background: #fff; border: 1px solid #f2f2f7; border-radius: 18px; padding: 10px; cursor: pointer; transition: 0.2s; display: flex; flex-direction: column; align-items: center; gap: 8px; }
   .mood-item:hover { border-color: var(--mf-primary); background: #fbfbfd; transform: translateY(-3px); }
   .mood-item img {
    object-fit: contain;
    width: 100%;
    height: -webkit-fill-available;
    /* max-width: 35px; */
    }

    .mood-item:first-child img {
        width: 120%;
    }

    .mood-item:nth-child(1) img {
        width: 120%;
    }

   .mood-item span { font-size: 9px; font-weight: 700; color: #c7c7cc; }
   .mf-input-textarea { width: 100%; height: 100px; border: 2px solid #f2f2f7; border-radius: 18px; padding: 15px; font-size: 15px; resize: none; margin-top: 10px; outline: none; }
   .modal-actions-grid { display: flex; gap: 10px; margin-top: 20px; }
   .mf-btn { flex: 1; padding: 14px; border-radius: 16px; font-size: 14px; font-weight: 700; cursor: pointer; border: none; }
   .mf-btn-primary { background: var(--mf-primary); color: #fff; }
   .mf-btn-secondary { background: #f2f2f7; color: var(--mf-text); }
   /* =========================================
   HISTORY LIST (Trong Modal)
   ========================================= */
.history-list { 
    display: flex; 
    flex-direction: column; 
    gap: 10px; 
    max-height: 280px; /* Giới hạn chiều cao để không làm tràn modal */
    overflow-y: auto; 
    padding: 5px;
}

/* Tùy chỉnh thanh cuộn cho lịch sử */
.history-list::-webkit-scrollbar { width: 4px; }
.history-list::-webkit-scrollbar-thumb { background: #e5e5ea; border-radius: 10px; }

.history-item { 
    display: flex; 
    align-items: center; 
    gap: 15px; 
    padding: 12px 18px; 
    background: #fbfbfd; 
    border-radius: 16px; 
    border: 1px solid #f2f2f7;
    cursor: pointer; 
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.history-item:hover { 
    background: #f2f2f7; 
    transform: translateX(5px); /* Hiệu ứng trượt nhẹ khi hover */
    border-color: #e5e5ea;
}

.history-item img { 
    width: 38px; 
    height: 38px; 
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.05));
    object-fit: contain;
}

.history-item > div {
    display: flex;
    flex-direction: column;
    gap: 2px;
    overflow: hidden; /* Cắt chữ nếu note quá dài */
}

.h-time { 
    font-size: 11px; 
    font-weight: 800; 
    color: var(--mf-text-muted); 
    letter-spacing: 0.3px;
}

.h-note { 
    font-size: 14px; 
    font-weight: 600; 
    color: var(--mf-text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* Hiện dấu ... nếu nội dung dài */
}
   
   /* Tooltip Fixed */
   .mf-action-tooltip { position: absolute; background: #1c1c1e; color: #fff; padding: 8px 12px; border-radius: 10px; font-size: 12px; font-weight: 700; z-index: 2000; transform: translate(-50%, -100%); pointer-events: none; box-shadow: 0 10px 20px rgba(0,0,0,0.2); transition: opacity 0.2s; }
   .mf-action-tooltip::after { content: ""; position: absolute; top: 100%; left: 50%; transform: translateX(-50%); border: 6px solid transparent; border-top-color: #1c1c1e; }
   .state-anim { animation: mfFadeUp 0.3s ease-out; }
   @keyframes mfFadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

   /* BIRTHDAY MOOD COLORS */
.px-box.birthday.s1 { background: var(--b1) !important; color: #fff; }
.px-box.birthday.s2 { background: var(--b2) !important; color: #fff; }
.px-box.birthday.s3 { background: var(--b3) !important; color: #fff; }
.px-box.birthday.s4 { background: var(--b4) !important; color: #d81b60; }
.px-box.birthday.s5 { background: var(--b5) !important; color: #d81b60; }

.px-box.birthday:not(.s1):not(.s2):not(.s3):not(.s4):not(.s5) { background: var(--birthday) !important; color: #fff; border: 2px solid #ff69b4; }
.px-box.today-highlight:not(.s1):not(.s2):not(.s3):not(.s4):not(.s5) { border: 2px solid var(--mf-primary); background: #fff; color: var(--mf-primary); }
.px-box.past-empty { background: #f2f2f7; color: rgba(0,0,0,0.3); }
.px-box.future { opacity: 0.3; cursor: default; }
.px-box:not(.future):hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }

/* Tooltip Fixed */
.mf-action-tooltip { position: absolute; background: #1c1c1e; color: #fff; padding: 8px 12px; border-radius: 10px; font-size: 12px; font-weight: 700; z-index: 2000; transform: translate(-50%, -100%); pointer-events: none; box-shadow: 0 10px 20px rgba(0,0,0,0.2); transition: opacity 0.2s; white-space: nowrap; min-width: max-content; }
.mf-action-tooltip::after { content: ""; position: absolute; top: 100%; left: 50%; transform: translateX(-50%); border: 6px solid transparent; border-top-color: #1c1c1e; }


